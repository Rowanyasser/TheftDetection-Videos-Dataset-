<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detection Results - Theft Detection System</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç Detection Results</h1>
        </div>

        {% if error %}
        <div class="result-card error-card">
            <div class="result-icon">‚ö†Ô∏è</div>
            <h2>Error</h2>
            <p class="result-message">{{ error }}</p>
            <a href="/" class="btn-back">‚Üê Try Again</a>
        </div>
        {% else %}
        <div class="result-card {% if is_theft %}theft-detected{% else %}no-theft{% endif %}">
            <div class="result-icon">
                {% if is_theft %}
                    ‚ö†Ô∏è
                {% else %}
                    ‚úÖ
                {% endif %}
            </div>
            
            <h2 class="result-title">{{ prediction }}</h2>
            
            <div class="confidence-bar">
                <div class="confidence-label">Confidence Level</div>
                <div class="confidence-meter">
                    <div class="confidence-fill" data-confidence="{{ confidence }}"></div>
                </div>
                <div class="confidence-value">{{ confidence }}</div>
            </div>

            <script>
                (function() {
                    var fills = document.querySelectorAll('.confidence-fill');
                    fills.forEach(function(el) {
                        var val = parseFloat(el.getAttribute('data-confidence')) || 0;
                        el.style.width = val + '%';
                    });
                })();
            </script>

            <div class="details-section">
                <div class="detail-item">
                    <span class="detail-label">Prediction:</span>
                    <span class="detail-value">{{ prediction }}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Model Confidence:</span>
                    <span class="detail-value">{{ confidence }}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Status:</span>
                    <span class="detail-value {% if is_theft %}status-alert{% else %}status-clear{% endif %}">
                        {% if is_theft %}ALERT{% else %}CLEAR{% endif %}
                    </span>
                </div>
            </div>

            <div class="action-buttons">
                <a href="/" class="btn-back">‚Üê Analyze Another Video</a>
            </div>

            {% if is_theft and suspicious_frames %}
            <div class="details-section" style="margin-top: 20px;">
                <h3>Most Suspicious Frames</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px; margin-top: 10px;">
                    {% for img in suspicious_frames %}
                    <div style="background: #1f1b2e; border: 1px solid rgba(255,255,255,0.08); border-radius: 10px; overflow: hidden;">
                        <img src="{{ img }}" alt="suspicious frame" style="width: 100%; height: 180px; object-fit: cover; display: block;">
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        </div>
        {% endif %}

        <footer>
            <p>Powered by R(2+1)D Deep Learning Model</p>
        </footer>
    </div>
</body>
</html>
